{"remainingRequest":"D:\\vuehr\\node_modules\\babel-loader\\lib\\index.js!D:\\vuehr\\src\\store\\index.js","dependencies":[{"path":"D:\\vuehr\\src\\store\\index.js","mtime":1608823168812},{"path":"D:\\vuehr\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\vuehr\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Lyrov5nmmK/kuIDkuKp2dWV4Ki8KaW1wb3J0IFZ1ZSBmcm9tICd2dWUnOwppbXBvcnQgVnVleCBmcm9tICd2dWV4JzsKVnVlLnVzZShWdWV4KTsKZXhwb3J0IGRlZmF1bHQgbmV3IFZ1ZXguU3RvcmUoewogIHN0YXRlOiB7CiAgICAvKuS7juacjeWKoeerr+WKoOi9veS4i+adpeeahOiPnOWNlemhuemDveaUvuWcqOi/meS4qnJvdXRlc+aVsOe7hOmHjOmdoiovCiAgICByb3V0ZXM6IFtdLAogICAgc2Vzc2lvbnM6IHt9LAogICAgaHJzOiBbXSwKICAgIGN1cnJlbnRTZXNzaW9uOiBudWxsLAogICAgY3VycmVudEhyOiBKU09OLnBhcnNlKHdpbmRvdy5zZXNzaW9uU3RvcmFnZS5nZXRJdGVtKCJ1c2VyIikpLAogICAgZmlsdGVyS2V5OiAnJywKICAgIHN0b21wOiBudWxsLAogICAgaXNEb3Q6IHt9CiAgfSwKCiAgLyrmm7TmlLkgVnVleCDnmoQgc3RvcmUg5Lit55qE54q25oCB55qE5ZSv5LiA5pa55rOV5piv5o+Q5LqkIG11dGF0aW9uKi8KICBtdXRhdGlvbnM6IHsKICAgIElOSVRfQ1VSUkVOVEhSOiBmdW5jdGlvbiBJTklUX0NVUlJFTlRIUihzdGF0ZSwgaHIpIHsKICAgICAgc3RhdGUuY3VycmVudEhyID0gaHI7CiAgICB9LAoKICAgIC8qKi8KICAgIGluaXRSb3V0ZXM6IGZ1bmN0aW9uIGluaXRSb3V0ZXMoc3RhdGUsIGRhdGEpIHsKICAgICAgc3RhdGUucm91dGVzID0gZGF0YTsKICAgIH0sCiAgICBjaGFuZ2VDdXJyZW50U2Vzc2lvbjogZnVuY3Rpb24gY2hhbmdlQ3VycmVudFNlc3Npb24oc3RhdGUsIGN1cnJlbnRTZXNzaW9uKSB7CiAgICAgIFZ1ZS5zZXQoc3RhdGUuaXNEb3QsIHN0YXRlLmN1cnJlbnRIci51c2VybmFtZSArICcjJyArIGN1cnJlbnRTZXNzaW9uLnVzZXJuYW1lLCBmYWxzZSk7CiAgICAgIHN0YXRlLmN1cnJlbnRTZXNzaW9uID0gY3VycmVudFNlc3Npb247CiAgICB9LAogICAgYWRkTWVzc2FnZTogZnVuY3Rpb24gYWRkTWVzc2FnZShzdGF0ZSwgbXNnKSB7CiAgICAgIHZhciBtc3MgPSBzdGF0ZS5zZXNzaW9uc1tzdGF0ZS5jdXJyZW50SHIudXNlcm5hbWUgKyAnIycgKyBtc2cudG9dOwoKICAgICAgaWYgKCFtc3MpIHsKICAgICAgICAvLyBzdGF0ZS5zZXNzaW9uc1tzdGF0ZS5jdXJyZW50SHIudXNlcm5hbWUrJyMnK21zZy50b10gPSBbXTsKICAgICAgICBWdWUuc2V0KHN0YXRlLnNlc3Npb25zLCBzdGF0ZS5jdXJyZW50SHIudXNlcm5hbWUgKyAnIycgKyBtc2cudG8sIFtdKTsKICAgICAgfQoKICAgICAgc3RhdGUuc2Vzc2lvbnNbc3RhdGUuY3VycmVudEhyLnVzZXJuYW1lICsgJyMnICsgbXNnLnRvXS5wdXNoKHsKICAgICAgICBjb250ZW50OiBtc2cuY29udGVudCwKICAgICAgICBkYXRlOiBuZXcgRGF0ZSgpLAogICAgICAgIHNlbGY6ICFtc2cubm90U2VsZgogICAgICB9KTsKICAgIH0sCiAgICBJTklUX0RBVEE6IGZ1bmN0aW9uIElOSVRfREFUQShzdGF0ZSkgewogICAgICAvL+a1j+iniOWZqOacrOWcsOeahOWOhuWPsuiBiuWkqeiusOW9leWPr+S7peWcqOi/memHjOWujOaIkAogICAgICB2YXIgZGF0YSA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKCd2dWUtY2hhdC1zZXNzaW9uJyk7CgogICAgICBpZiAoZGF0YSkgewogICAgICAgIHN0YXRlLnNlc3Npb25zID0gSlNPTi5wYXJzZShkYXRhKTsKICAgICAgfQogICAgfSwKICAgIElOSVRfSFI6IGZ1bmN0aW9uIElOSVRfSFIoc3RhdGUsIGRhdGEpIHsKICAgICAgc3RhdGUuaHJzID0gZGF0YTsKICAgIH0KICB9LAogIGFjdGlvbnM6IHsKICAgIGNvbm5lY3Q6IGZ1bmN0aW9uIGNvbm5lY3QoY29udGV4dCkgewogICAgICBjb250ZXh0LnN0YXRlLnN0b21wID0gU3RvbXAub3ZlcihuZXcgU29ja0pTKCcvd3MvZXAnKSk7CiAgICAgIGNvbnRleHQuc3RhdGUuc3RvbXAuY29ubmVjdCh7fSwgZnVuY3Rpb24gKHN1Y2Nlc3MpIHsKICAgICAgICBjb250ZXh0LnN0YXRlLnN0b21wLnN1YnNjcmliZSgnL3VzZXIvcXVldWUvY2hhdCcsIGZ1bmN0aW9uIChtc2cpIHsKICAgICAgICAgIHZhciByZWNlaXZlTXNnID0gSlNPTi5wYXJzZShtc2cuYm9keSk7CgogICAgICAgICAgaWYgKCFjb250ZXh0LnN0YXRlLmN1cnJlbnRTZXNzaW9uIHx8IHJlY2VpdmVNc2cuZnJvbSAhPSBjb250ZXh0LnN0YXRlLmN1cnJlbnRTZXNzaW9uLnVzZXJuYW1lKSB7CiAgICAgICAgICAgIE5vdGlmaWNhdGlvbi5pbmZvKHsKICAgICAgICAgICAgICB0aXRsZTogJ+OAkCcgKyByZWNlaXZlTXNnLmZyb21OaWNrbmFtZSArICfjgJHlj5HmnaXkuIDmnaHmtojmga8nLAogICAgICAgICAgICAgIG1lc3NhZ2U6IHJlY2VpdmVNc2cuY29udGVudC5sZW5ndGggPiAxMCA/IHJlY2VpdmVNc2cuY29udGVudC5zdWJzdHIoMCwgMTApIDogcmVjZWl2ZU1zZy5jb250ZW50LAogICAgICAgICAgICAgIHBvc2l0aW9uOiAnYm90dG9tLXJpZ2h0JwogICAgICAgICAgICB9KTsKICAgICAgICAgICAgVnVlLnNldChjb250ZXh0LnN0YXRlLmlzRG90LCBjb250ZXh0LnN0YXRlLmN1cnJlbnRIci51c2VybmFtZSArICcjJyArIHJlY2VpdmVNc2cuZnJvbSwgdHJ1ZSk7CiAgICAgICAgICB9CgogICAgICAgICAgcmVjZWl2ZU1zZy5ub3RTZWxmID0gdHJ1ZTsKICAgICAgICAgIHJlY2VpdmVNc2cudG8gPSByZWNlaXZlTXNnLmZyb207CiAgICAgICAgICBjb250ZXh0LmNvbW1pdCgnYWRkTWVzc2FnZScsIHJlY2VpdmVNc2cpOwogICAgICAgIH0pOwogICAgICB9LCBmdW5jdGlvbiAoZXJyb3IpIHt9KTsKICAgIH0sCiAgICBpbml0RGF0YTogZnVuY3Rpb24gaW5pdERhdGEoY29udGV4dCkgewogICAgICBjb250ZXh0LmNvbW1pdCgnSU5JVF9EQVRBJyk7CiAgICAgIGdldFJlcXVlc3QoIi9jaGF0L2hycyIpLnRoZW4oZnVuY3Rpb24gKHJlc3ApIHsKICAgICAgICBpZiAocmVzcCkgewogICAgICAgICAgY29udGV4dC5jb21taXQoJ0lOSVRfSFInLCByZXNwKTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfQogIH0KfSk7CnN0b3JlLndhdGNoKGZ1bmN0aW9uIChzdGF0ZSkgewogIHJldHVybiBzdGF0ZS5zZXNzaW9uczsKfSwgZnVuY3Rpb24gKHZhbCkgewogIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCd2dWUtY2hhdC1zZXNzaW9uJywgSlNPTi5zdHJpbmdpZnkodmFsKSk7Cn0sIHsKICBkZWVwOiB0cnVlCiAgLyrov5nkuKrosozkvLzmmK/lvIDlkK93YXRjaOebkea1i+eahOWIpOaWrSzlrpjmlrnor7TmmI7kuZ/mr5TovoPmqKHns4oqLwoKfSk7"},{"version":3,"sources":["D:/vuehr/src/store/index.js"],"names":["Vue","Vuex","use","Store","state","routes","sessions","hrs","currentSession","currentHr","JSON","parse","window","sessionStorage","getItem","filterKey","stomp","isDot","mutations","INIT_CURRENTHR","hr","initRoutes","data","changeCurrentSession","set","username","addMessage","msg","mss","to","push","content","date","Date","self","notSelf","INIT_DATA","localStorage","INIT_HR","actions","connect","context","Stomp","over","SockJS","success","subscribe","receiveMsg","body","from","Notification","info","title","fromNickname","message","length","substr","position","commit","error","initData","getRequest","then","resp","store","watch","val","setItem","stringify","deep"],"mappings":"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","sourcesContent":["/*这是一个vuex*/\r\nimport Vue from 'vue'\r\nimport Vuex from 'vuex'\r\n\r\nVue.use(Vuex)\r\n\r\nexport default new Vuex.Store({\r\n    state:{\r\n        /*从服务端加载下来的菜单项都放在这个routes数组里面*/\r\n        routes:[],\r\n        sessions: {},\r\n        hrs: [],\r\n        currentSession: null,\r\n        currentHr: JSON.parse(window.sessionStorage.getItem(\"user\")),\r\n        filterKey: '',\r\n        stomp: null,\r\n        isDot: {}\r\n    },\r\n    /*更改 Vuex 的 store 中的状态的唯一方法是提交 mutation*/\r\n    mutations:{\r\n        INIT_CURRENTHR(state, hr) {\r\n            state.currentHr = hr;\r\n        },\r\n        /**/\r\n        initRoutes(state, data) {\r\n            state.routes = data;\r\n        },\r\n        changeCurrentSession(state, currentSession) {\r\n            Vue.set(state.isDot, state.currentHr.username + '#' + currentSession.username, false);\r\n            state.currentSession = currentSession;\r\n        },\r\n        addMessage(state, msg) {\r\n            let mss = state.sessions[state.currentHr.username + '#' + msg.to];\r\n            if (!mss) {\r\n                // state.sessions[state.currentHr.username+'#'+msg.to] = [];\r\n                Vue.set(state.sessions, state.currentHr.username + '#' + msg.to, []);\r\n            }\r\n            state.sessions[state.currentHr.username + '#' + msg.to].push({\r\n                content: msg.content,\r\n                date: new Date(),\r\n                self: !msg.notSelf\r\n            })\r\n        },\r\n        INIT_DATA(state) {\r\n            //浏览器本地的历史聊天记录可以在这里完成\r\n            let data = localStorage.getItem('vue-chat-session');\r\n            if (data) {\r\n                state.sessions = JSON.parse(data);\r\n            }\r\n        },\r\n        INIT_HR(state, data) {\r\n            state.hrs = data;\r\n        }\r\n    },\r\n    actions:{\r\n        connect(context) {\r\n            context.state.stomp = Stomp.over(new SockJS('/ws/ep'));\r\n            context.state.stomp.connect({}, success => {\r\n                context.state.stomp.subscribe('/user/queue/chat', msg => {\r\n                    let receiveMsg = JSON.parse(msg.body);\r\n                    if (!context.state.currentSession || receiveMsg.from != context.state.currentSession.username) {\r\n                        Notification.info({\r\n                            title: '【' + receiveMsg.fromNickname + '】发来一条消息',\r\n                            message: receiveMsg.content.length > 10 ? receiveMsg.content.substr(0, 10) : receiveMsg.content,\r\n                            position: 'bottom-right'\r\n                        })\r\n                        Vue.set(context.state.isDot, context.state.currentHr.username + '#' + receiveMsg.from, true);\r\n                    }\r\n                    receiveMsg.notSelf = true;\r\n                    receiveMsg.to = receiveMsg.from;\r\n                    context.commit('addMessage', receiveMsg);\r\n                })\r\n            }, error => {\r\n\r\n            })\r\n        },\r\n        initData(context) {\r\n            context.commit('INIT_DATA')\r\n            getRequest(\"/chat/hrs\").then(resp => {\r\n                if (resp) {\r\n                    context.commit('INIT_HR', resp);\r\n                }\r\n            })\r\n        }\r\n    }\r\n})\r\n\r\nstore.watch(function (state) {\r\n    return state.sessions\r\n}, function (val) {\r\n    localStorage.setItem('vue-chat-session', JSON.stringify(val));\r\n}, {\r\n    deep: true/*这个貌似是开启watch监测的判断,官方说明也比较模糊*/\r\n})\r\n"]}]}