{"remainingRequest":"/Users/lyuxiyang/Documents/gitProject/microhr/vuehr/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/lyuxiyang/Documents/gitProject/microhr/vuehr/src/views/sys/SysHr.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/lyuxiyang/Documents/gitProject/microhr/vuehr/src/views/sys/SysHr.vue","mtime":1625467519762},{"path":"/Users/lyuxiyang/Documents/gitProject/microhr/vuehr/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/lyuxiyang/Documents/gitProject/microhr/vuehr/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/Users/lyuxiyang/Documents/gitProject/microhr/vuehr/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/lyuxiyang/Documents/gitProject/microhr/vuehr/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAiU3lzQmFzaWMiLAogIGRhdGEoKXsKICAgIHJldHVybnsKICAgICAga2V5d29yZHM6ICcnLAogICAgICBocnM6IFtdLAogICAgICBzZWxlY3RlZFJvbGVzOiBbXSwKICAgICAgYWxscm9sZXM6IFtdCiAgICB9CiAgfSwKICBtb3VudGVkKCkgewogICAgdGhpcy5pbml0SHJzKCk7CiAgfSwKICBtZXRob2RzOnsKICAgIGluaXRBbGxSb2xlcygpIHsKICAgICAgdGhpcy5nZXRSZXF1ZXN0KCIvc3lzdGVtL2hyL3JvbGVzIikudGhlbihyZXNwID0+IHsKICAgICAgICBpZiAocmVzcCkgewogICAgICAgICAgdGhpcy5hbGxyb2xlcyA9IHJlc3A7CiAgICAgICAgfQogICAgICB9KQogICAgfSwKICAgIGhpZGVQb3AoaHIpIHsKICAgICAgbGV0IHJvbGVzID0gW107CiAgICAgIE9iamVjdC5hc3NpZ24ocm9sZXMsIGhyLnJvbGVzKTsKICAgICAgbGV0IGZsYWcgPSBmYWxzZTsKICAgICAgaWYgKHJvbGVzLmxlbmd0aCAhPSB0aGlzLnNlbGVjdGVkUm9sZXMubGVuZ3RoKSB7CiAgICAgICAgZmxhZyA9IHRydWU7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCByb2xlcy5sZW5ndGg7IGkrKykgewogICAgICAgICAgbGV0IHJvbGUgPSByb2xlc1tpXTsKICAgICAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgdGhpcy5zZWxlY3RlZFJvbGVzLmxlbmd0aDsgaisrKSB7CiAgICAgICAgICAgIGxldCBzciA9IHRoaXMuc2VsZWN0ZWRSb2xlc1tqXTsKICAgICAgICAgICAgaWYgKHJvbGUuaWQgPT0gc3IpIHsKICAgICAgICAgICAgICByb2xlcy5zcGxpY2UoaSwgMSk7CiAgICAgICAgICAgICAgaS0tOwogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGlmIChyb2xlcy5sZW5ndGggIT0gMCkgewogICAgICAgICAgZmxhZyA9IHRydWU7CiAgICAgICAgfQogICAgICB9CiAgICAgIGlmIChmbGFnKSB7CiAgICAgICAgbGV0IHVybCA9ICcvc3lzdGVtL2hyL3JvbGU/aHJpZD0nICsgaHIuaWQ7CiAgICAgICAgdGhpcy5zZWxlY3RlZFJvbGVzLmZvckVhY2goc3IgPT4gewogICAgICAgICAgdXJsICs9ICcmcmlkcz0nICsgc3I7CiAgICAgICAgfSk7CiAgICAgICAgdGhpcy5wdXRSZXF1ZXN0KHVybCkudGhlbihyZXNwID0+IHsKICAgICAgICAgIGlmIChyZXNwKSB7CiAgICAgICAgICAgIHRoaXMuaW5pdEhycygpOwogICAgICAgICAgfQogICAgICAgIH0pOwogICAgICB9CiAgICB9LAogICAgc2hvd1BvcChocikgewogICAgICB0aGlzLmluaXRBbGxSb2xlcygpOwogICAgICBsZXQgcm9sZXMgPSBoci5yb2xlczsKICAgICAgdGhpcy5zZWxlY3RlZFJvbGVzID0gW107CiAgICAgIHJvbGVzLmZvckVhY2gociA9PiB7CiAgICAgICAgdGhpcy5zZWxlY3RlZFJvbGVzLnB1c2goci5pZCk7CiAgICAgIH0pCiAgICB9LAogICAgZW5hYmxlZENoYW5nZShocikgewogICAgICBkZWxldGUgaHIucm9sZXM7CiAgICAgIHRoaXMucHV0UmVxdWVzdCgiL3N5c3RlbS9oci8iLCBocikudGhlbihyZXNwID0+IHsKICAgICAgICBpZiAocmVzcCkgewogICAgICAgICAgdGhpcy5pbml0SHJzKCk7CiAgICAgICAgfQogICAgICB9KQogICAgfSwKICAgIGRlbGV0ZUhyKGhyKSB7CiAgICAgIHRoaXMuJGNvbmZpcm0oJ+atpOaTjeS9nOWwhuawuOS5heWIoOmZpOOAkCcraHIubmFtZSsn44CRLCDmmK/lkKbnu6fnu60/JywgJ+aPkOekuicsIHsKICAgICAgICBjb25maXJtQnV0dG9uVGV4dDogJ+ehruWumicsCiAgICAgICAgY2FuY2VsQnV0dG9uVGV4dDogJ+WPlua2iCcsCiAgICAgICAgdHlwZTogJ3dhcm5pbmcnCiAgICAgIH0pLnRoZW4oKCkgPT4gewogICAgICAgIHRoaXMuZGVsZXRlUmVxdWVzdCgiL3N5c3RlbS9oci8iK2hyLmlkKS50aGVuKHJlc3A9PnsKICAgICAgICAgIGlmIChyZXNwKSB7CiAgICAgICAgICAgIHRoaXMuaW5pdEhycygpOwogICAgICAgICAgfQogICAgICAgIH0pCiAgICAgIH0pLmNhdGNoKCgpID0+IHsKICAgICAgICB0aGlzLiRtZXNzYWdlKHsKICAgICAgICAgIHR5cGU6ICdpbmZvJywKICAgICAgICAgIG1lc3NhZ2U6ICflt7Llj5bmtojliKDpmaQnCiAgICAgICAgfSk7CiAgICAgIH0pOwogICAgfSwKICAgIGRvU2VhcmNoKCkgewogICAgICB0aGlzLmluaXRIcnMoKTsKICAgIH0sCiAgICBpbml0SHJzKCkgewogICAgICB0aGlzLmdldFJlcXVlc3QoIi9zeXN0ZW0vaHIvP2tleXdvcmRzPSIrdGhpcy5rZXl3b3JkcykudGhlbihyZXNwID0+IHsKICAgICAgICBpZiAocmVzcCkgewogICAgICAgICAgdGhpcy5ocnMgPSByZXNwOwogICAgICAgIH0KICAgICAgfSkKICAgIH0KICB9Cn0K"},{"version":3,"sources":["SysHr.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAyEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"SysHr.vue","sourceRoot":"src/views/sys","sourcesContent":["<template>\n<!--  操作员管理-->\n  <div>\n    <div style=\"margin-top: 10px;display: flex;justify-content: center\">\n      <el-input v-model=\"keywords\" placeholder=\"通过用户名搜索用户...\" prefix-icon=\"el-icon-search\"\n                style=\"width: 400px;margin-right: 10px\" @keydown.enter.native=\"doSearch\"></el-input>\n      <el-button icon=\"el-icon-search\" type=\"primary\" @click=\"doSearch\">搜索</el-button>\n    </div>\n\n    <div class=\"hr-container\">\n      <el-card class=\"hr-card\" v-for=\"(hr,index) in hrs\" :key=\"index\">\n        <div slot=\"header\" class=\"clearfix\">\n          <span>{{hr.name}}</span>\n          <el-button style=\"float: right; padding: 3px 0;color: #e30007;\" type=\"text\"\n                     icon=\"el-icon-delete\" @click=\"deleteHr(hr)\"></el-button>\n        </div>\n        <div>\n<!--          用户头像-->\n          <div class=\"img-container\">\n            <img :src=\"hr.userface\" :alt=\"hr.name\" :title=\"hr.name\" class=\"userface-img\">\n          </div>\n          <div class=\"userinfo-container\">\n            <div>用户名：{{hr.name}}</div>\n            <div>手机号码：{{hr.phone}}</div>\n            <div>电话号码：{{hr.telephone}}</div>\n            <div>地址：{{hr.address}}</div>\n            <div>用户状态：\n              <el-switch\n                  v-model=\"hr.enabled\"\n                  active-text=\"启用\"\n                  @change=\"enabledChange(hr)\"\n                  active-color=\"#13ce66\"\n                  inactive-color=\"#ff4949\"\n                  inactive-text=\"禁用\">\n              </el-switch>\n            </div>\n            <div>用户角色：\n              <el-tag type=\"success\" style=\"margin-right: 4px\" v-for=\"(role,indexj) in hr.roles\"\n                      :key=\"indexj\">{{role.nameZh}}\n              </el-tag>\n\n\n<!--Popover 弹出框-->\n              <el-popover\n                  placement=\"right\"\n                  title=\"角色列表\"\n                  @show=\"showPop(hr)\"\n                  @hide=\"hidePop(hr)\"\n                  width=\"200\"\n                  trigger=\"click\">\n<!--                selectedRoles表示预选中-->\n                <el-select v-model=\"selectedRoles\" multiple placeholder=\"请选择\">\n<!--                  选择框-->\n                  <el-option\n                      v-for=\"(r,indexk) in allroles\"\n                      :key=\"indexk\"\n                      :label=\"r.nameZh\"\n                      :value=\"r.id\">\n                  </el-option>\n                </el-select>\n                <el-button slot=\"reference\" icon=\"el-icon-more\" type=\"text\"></el-button>\n              </el-popover>\n            </div>\n            <div>备注：{{hr.remark}}</div>\n          </div>\n        </div>\n      </el-card>\n\n    </div>\n  </div>\n</template>\n\n<script>\nexport default {\n  name: \"SysBasic\",\n  data(){\n    return{\n      keywords: '',\n      hrs: [],\n      selectedRoles: [],\n      allroles: []\n    }\n  },\n  mounted() {\n    this.initHrs();\n  },\n  methods:{\n    initAllRoles() {\n      this.getRequest(\"/system/hr/roles\").then(resp => {\n        if (resp) {\n          this.allroles = resp;\n        }\n      })\n    },\n    hidePop(hr) {\n      let roles = [];\n      Object.assign(roles, hr.roles);\n      let flag = false;\n      if (roles.length != this.selectedRoles.length) {\n        flag = true;\n      } else {\n        for (let i = 0; i < roles.length; i++) {\n          let role = roles[i];\n          for (let j = 0; j < this.selectedRoles.length; j++) {\n            let sr = this.selectedRoles[j];\n            if (role.id == sr) {\n              roles.splice(i, 1);\n              i--;\n              break;\n            }\n          }\n        }\n        if (roles.length != 0) {\n          flag = true;\n        }\n      }\n      if (flag) {\n        let url = '/system/hr/role?hrid=' + hr.id;\n        this.selectedRoles.forEach(sr => {\n          url += '&rids=' + sr;\n        });\n        this.putRequest(url).then(resp => {\n          if (resp) {\n            this.initHrs();\n          }\n        });\n      }\n    },\n    showPop(hr) {\n      this.initAllRoles();\n      let roles = hr.roles;\n      this.selectedRoles = [];\n      roles.forEach(r => {\n        this.selectedRoles.push(r.id);\n      })\n    },\n    enabledChange(hr) {\n      delete hr.roles;\n      this.putRequest(\"/system/hr/\", hr).then(resp => {\n        if (resp) {\n          this.initHrs();\n        }\n      })\n    },\n    deleteHr(hr) {\n      this.$confirm('此操作将永久删除【'+hr.name+'】, 是否继续?', '提示', {\n        confirmButtonText: '确定',\n        cancelButtonText: '取消',\n        type: 'warning'\n      }).then(() => {\n        this.deleteRequest(\"/system/hr/\"+hr.id).then(resp=>{\n          if (resp) {\n            this.initHrs();\n          }\n        })\n      }).catch(() => {\n        this.$message({\n          type: 'info',\n          message: '已取消删除'\n        });\n      });\n    },\n    doSearch() {\n      this.initHrs();\n    },\n    initHrs() {\n      this.getRequest(\"/system/hr/?keywords=\"+this.keywords).then(resp => {\n        if (resp) {\n          this.hrs = resp;\n        }\n      })\n    }\n  }\n}\n</script>\n\n<style scoped>\n.userinfo-container div {\n  font-size: 12px;\n  color: #409eff;\n}\n\n.userinfo-container {\n  margin-top: 20px;\n}\n\n.img-container {\n  width: 100%;\n  display: flex;\n  justify-content: center;\n}\n\n.userface-img {\n  width: 72px;\n  height: 72px;\n  border-radius: 72px;\n}\n\n.hr-container {\n  margin-top: 10px;\n  display: flex;\n  flex-wrap: wrap;\n  justify-content: space-around;\n}\n\n.hr-card {\n  width: 350px;\n  margin-bottom: 20px;\n}\n</style>"]}]}