{"remainingRequest":"/Users/lyuxiyang/Documents/gitProject/microhr/vuehr/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/lyuxiyang/Documents/gitProject/microhr/vuehr/src/views/HrInfo.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/lyuxiyang/Documents/gitProject/microhr/vuehr/src/views/HrInfo.vue","mtime":1625467519760},{"path":"/Users/lyuxiyang/Documents/gitProject/microhr/vuehr/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/lyuxiyang/Documents/gitProject/microhr/vuehr/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/Users/lyuxiyang/Documents/gitProject/microhr/vuehr/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/lyuxiyang/Documents/gitProject/microhr/vuehr/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAiSHJJbmZvIiwKICBkYXRhKCkgewogICAgY29uc3QgdmFsaWRhdGVQYXNzID0gKHJ1bGUsIHZhbHVlLCBjYWxsYmFjaykgPT4gewogICAgICBpZiAodmFsdWUgPT09ICcnKSB7CiAgICAgICAgY2FsbGJhY2sobmV3IEVycm9yKCfor7fovpPlhaXlr4bnoIEnKSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgaWYgKHRoaXMucnVsZUZvcm0uY2hlY2tQYXNzICE9PSAnJykgewogICAgICAgICAgdGhpcy4kcmVmcy5ydWxlRm9ybS52YWxpZGF0ZUZpZWxkKCdjaGVja1Bhc3MnKTsKICAgICAgICB9CiAgICAgICAgY2FsbGJhY2soKTsKICAgICAgfQogICAgfTsKICAgIGNvbnN0IHZhbGlkYXRlUGFzczIgPSAocnVsZSwgdmFsdWUsIGNhbGxiYWNrKSA9PiB7CiAgICAgIGlmICh2YWx1ZSA9PT0gJycpIHsKICAgICAgICBjYWxsYmFjayhuZXcgRXJyb3IoJ+ivt+WGjeasoei+k+WFpeWvhueggScpKTsKICAgICAgfSBlbHNlIGlmICh2YWx1ZSAhPT0gdGhpcy5ydWxlRm9ybS5wYXNzKSB7CiAgICAgICAgY2FsbGJhY2sobmV3IEVycm9yKCfkuKTmrKHovpPlhaXlr4bnoIHkuI3kuIDoh7QhJykpOwogICAgICB9IGVsc2UgewogICAgICAgIGNhbGxiYWNrKCk7CiAgICAgIH0KICAgIH07CiAgICByZXR1cm4gewogICAgICBydWxlRm9ybTogewogICAgICAgIG9sZHBhc3M6ICcnLAogICAgICAgIHBhc3M6ICcnLAogICAgICAgIGNoZWNrUGFzczogJycKICAgICAgfSwKICAgICAgcnVsZXM6IHsKICAgICAgICBvbGRwYXNzOiBbCiAgICAgICAgICB7dmFsaWRhdG9yOiB2YWxpZGF0ZVBhc3MsIHRyaWdnZXI6ICdibHVyJ30KICAgICAgICBdLAogICAgICAgIHBhc3M6IFsKICAgICAgICAgIHt2YWxpZGF0b3I6IHZhbGlkYXRlUGFzcywgdHJpZ2dlcjogJ2JsdXInfQogICAgICAgIF0sCiAgICAgICAgY2hlY2tQYXNzOiBbCiAgICAgICAgICB7dmFsaWRhdG9yOiB2YWxpZGF0ZVBhc3MyLCB0cmlnZ2VyOiAnYmx1cid9CiAgICAgICAgXQogICAgICB9LAogICAgICBocjogbnVsbCwKICAgICAgaHIyOiBudWxsLAogICAgICBkaWFsb2dWaXNpYmxlOiBmYWxzZSwKICAgICAgcGFzc3dkRGlhbG9nVmlzaWJsZTogZmFsc2UKICAgIH0KICB9LAogIG1vdW50ZWQoKSB7CiAgICB0aGlzLmluaXRIcigpOwogIH0sCiAgbWV0aG9kczogewogICAgb25TdWNjZXNzKCkgewogICAgICB0aGlzLmluaXRIcigpOwogICAgfSwKICAgIHVwZGF0ZUhySW5mbygpIHsKICAgICAgdGhpcy5wdXRSZXF1ZXN0KCIvaHIvaW5mbyIsIHRoaXMuaHIyKS50aGVuKHJlc3AgPT4gewogICAgICAgIGlmIChyZXNwKSB7CiAgICAgICAgICB0aGlzLmRpYWxvZ1Zpc2libGUgPSBmYWxzZTsKICAgICAgICAgIHRoaXMuaW5pdEhyKCk7CiAgICAgICAgfQogICAgICB9KQogICAgfSwKICAgIHNob3dVcGRhdGVIckluZm9WaWV3KCkgewogICAgICB0aGlzLmRpYWxvZ1Zpc2libGUgPSB0cnVlOwogICAgfSwKICAgIHN1Ym1pdEZvcm0oZm9ybU5hbWUpIHsKICAgICAgdGhpcy4kcmVmc1tmb3JtTmFtZV0udmFsaWRhdGUoKHZhbGlkKSA9PiB7CiAgICAgICAgaWYgKHZhbGlkKSB7CiAgICAgICAgICB0aGlzLnJ1bGVGb3JtLmhyaWQgPSB0aGlzLmhyLmlkOwogICAgICAgICAgdGhpcy5wdXRSZXF1ZXN0KCIvaHIvcGFzcyIsIHRoaXMucnVsZUZvcm0pLnRoZW4ocmVzcCA9PiB7CiAgICAgICAgICAgIGlmIChyZXNwKSB7CiAgICAgICAgICAgICAgdGhpcy5nZXRSZXF1ZXN0KCIvbG9nb3V0Iik7CiAgICAgICAgICAgICAgd2luZG93LnNlc3Npb25TdG9yYWdlLnJlbW92ZUl0ZW0oInVzZXIiKQogICAgICAgICAgICAgIHRoaXMuJHN0b3JlLmNvbW1pdCgnaW5pdFJvdXRlcycsIFtdKTsKICAgICAgICAgICAgICB0aGlzLiRyb3V0ZXIucmVwbGFjZSgiLyIpOwogICAgICAgICAgICB9CiAgICAgICAgICB9KQogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgfQogICAgICB9KTsKICAgIH0sCiAgICByZXNldEZvcm0oZm9ybU5hbWUpIHsKICAgICAgdGhpcy4kcmVmc1tmb3JtTmFtZV0ucmVzZXRGaWVsZHMoKTsKICAgIH0sCiAgICBzaG93VXBkYXRlUGFzc3dkVmlldygpIHsKICAgICAgdGhpcy5wYXNzd2REaWFsb2dWaXNpYmxlID0gdHJ1ZTsKICAgIH0sCiAgICBpbml0SHIoKSB7CiAgICAgIHRoaXMuZ2V0UmVxdWVzdCgnL2hyL2luZm8nKS50aGVuKHJlc3AgPT4gewogICAgICAgIGlmIChyZXNwKSB7CiAgICAgICAgICB0aGlzLmhyID0gcmVzcDsKICAgICAgICAgIC8q5oqKaHLnmoTlgLzotYvlgLznu5locjIqLwogICAgICAgICAgdGhpcy5ocjIgPSBPYmplY3QuYXNzaWduKHt9LCB0aGlzLmhyKTsKICAgICAgICAgIHdpbmRvdy5zZXNzaW9uU3RvcmFnZS5zZXRJdGVtKCJ1c2VyIiwgSlNPTi5zdHJpbmdpZnkocmVzcCkpOwogICAgICAgICAgdGhpcy4kc3RvcmUuY29tbWl0KCdJTklUX0NVUlJFTlRIUicsIHJlc3ApOwogICAgICAgIH0KICAgICAgfSkKICAgIH0KICB9Cn0K"},{"version":3,"sources":["HrInfo.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA+GA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"HrInfo.vue","sourceRoot":"src/views","sourcesContent":["<template>\n  <div v-if=\"hr\" >\n    <el-card class=\"box-card\" style=\"width: 400px;\">\n      <div slot=\"header\" class=\"clearfix\">\n        <span>{{hr.name}}</span>\n      </div>\n      <div>\n        <div style=\"display: flex;justify-content: center; margin-bottom: 8px\" >\n          <el-upload\n              :show-file-list=\"false\"\n              :on-success=\"onSuccess\"\n              :data=\"hr\"\n              action=\"/hr/userface\">\n            <img title=\"点击修改用户图像\" :src=\"hr.userface\" style=\"width: 100px;height: 100px;border-radius: 50px\"\n                 alt=\"\">\n          </el-upload>\n        </div>\n        <div style=\"margin-bottom: 5px\">电话号码：\n          <el-tag size=\"mini\">{{hr.telephone}}</el-tag>\n        </div>\n        <div style=\"margin-bottom: 5px\">手机号码：\n          <el-tag size=\"mini\">{{hr.phone}}</el-tag>\n        </div>\n        <div style=\"margin-bottom: 5px\">居住地址：\n          <el-tag size=\"mini\">{{hr.address}}</el-tag>\n        </div>\n        <div style=\"margin-bottom: 5px\">用户标签：\n          <el-tag  size=\"mini\" type=\"success\" style=\"margin-right: 5px\" v-for=\"(r,index) in hr.roles\" :key=\"index\">\n            {{r.nameZh}}\n          </el-tag>\n        </div>\n        <div style=\"display: flex;justify-content: space-around;margin-top: 10px\">\n          <el-button type=\"primary\" @click=\"showUpdateHrInfoView\">修改信息</el-button>\n          <el-button type=\"danger\" @click=\"showUpdatePasswdView\">修改密码</el-button>\n        </div>\n      </div>\n    </el-card>\n\n<!--    hr2的值是在initHr()的时候从hr拷贝过来的，专门在对话框中使用的-->\n    <el-dialog\n        title=\"修改用户信息\"\n        :visible.sync=\"dialogVisible\"\n        width=\"30%\">\n      <div>\n        <table>\n          <tr>\n            <td>\n              <el-tag>用户昵称：</el-tag>\n            </td>\n            <td>\n              <el-input v-model=\"hr2.name\"></el-input>\n            </td>\n          </tr>\n          <tr>\n            <td>\n              <el-tag>电话号码：</el-tag>\n            </td>\n            <td>\n              <el-input v-model=\"hr2.telephone\"></el-input>\n            </td>\n          </tr>\n          <tr>\n            <td>\n              <el-tag>手机号码：</el-tag>\n            </td>\n            <td>\n              <el-input v-model=\"hr2.phone\"></el-input>\n            </td>\n          </tr>\n          <tr>\n            <td>\n              <el-tag>用户地址：</el-tag>\n            </td>\n            <td>\n              <el-input v-model=\"hr2.address\"></el-input>\n            </td>\n          </tr>\n        </table>\n      </div>\n      <span slot=\"footer\" class=\"dialog-footer\">\n    <el-button @click=\"dialogVisible = false\">取 消</el-button>\n    <el-button type=\"primary\" @click=\"updateHrInfo\">确 定</el-button>\n  </span>\n    </el-dialog>\n    <el-dialog\n        title=\"修改密码\"\n        :visible.sync=\"passwdDialogVisible\"\n        width=\"30%\">\n      <div>\n        <el-form :model=\"ruleForm\" status-icon :rules=\"rules\" ref=\"ruleForm\" label-width=\"100px\"\n                 class=\"demo-ruleForm\">\n          <el-form-item label=\"请输入旧密码\" prop=\"oldpass\">\n            <el-input type=\"password\" v-model=\"ruleForm.oldpass\" autocomplete=\"off\"></el-input>\n          </el-form-item>\n          <el-form-item label=\"请输入新密码\" prop=\"pass\">\n            <el-input type=\"password\" v-model=\"ruleForm.pass\" autocomplete=\"off\"></el-input>\n          </el-form-item>\n          <el-form-item label=\"新确认密码\" prop=\"checkPass\">\n            <el-input type=\"password\" v-model=\"ruleForm.checkPass\" autocomplete=\"off\"></el-input>\n          </el-form-item>\n          <el-form-item>\n            <el-button type=\"primary\" @click=\"submitForm('ruleForm')\">提交</el-button>\n            <el-button @click=\"resetForm('ruleForm')\">重置</el-button>\n          </el-form-item>\n        </el-form>\n      </div>\n    </el-dialog>\n  </div>\n</template>\n\n<script>\nexport default {\n  name: \"HrInfo\",\n  data() {\n    const validatePass = (rule, value, callback) => {\n      if (value === '') {\n        callback(new Error('请输入密码'));\n      } else {\n        if (this.ruleForm.checkPass !== '') {\n          this.$refs.ruleForm.validateField('checkPass');\n        }\n        callback();\n      }\n    };\n    const validatePass2 = (rule, value, callback) => {\n      if (value === '') {\n        callback(new Error('请再次输入密码'));\n      } else if (value !== this.ruleForm.pass) {\n        callback(new Error('两次输入密码不一致!'));\n      } else {\n        callback();\n      }\n    };\n    return {\n      ruleForm: {\n        oldpass: '',\n        pass: '',\n        checkPass: ''\n      },\n      rules: {\n        oldpass: [\n          {validator: validatePass, trigger: 'blur'}\n        ],\n        pass: [\n          {validator: validatePass, trigger: 'blur'}\n        ],\n        checkPass: [\n          {validator: validatePass2, trigger: 'blur'}\n        ]\n      },\n      hr: null,\n      hr2: null,\n      dialogVisible: false,\n      passwdDialogVisible: false\n    }\n  },\n  mounted() {\n    this.initHr();\n  },\n  methods: {\n    onSuccess() {\n      this.initHr();\n    },\n    updateHrInfo() {\n      this.putRequest(\"/hr/info\", this.hr2).then(resp => {\n        if (resp) {\n          this.dialogVisible = false;\n          this.initHr();\n        }\n      })\n    },\n    showUpdateHrInfoView() {\n      this.dialogVisible = true;\n    },\n    submitForm(formName) {\n      this.$refs[formName].validate((valid) => {\n        if (valid) {\n          this.ruleForm.hrid = this.hr.id;\n          this.putRequest(\"/hr/pass\", this.ruleForm).then(resp => {\n            if (resp) {\n              this.getRequest(\"/logout\");\n              window.sessionStorage.removeItem(\"user\")\n              this.$store.commit('initRoutes', []);\n              this.$router.replace(\"/\");\n            }\n          })\n        } else {\n          return false;\n        }\n      });\n    },\n    resetForm(formName) {\n      this.$refs[formName].resetFields();\n    },\n    showUpdatePasswdView() {\n      this.passwdDialogVisible = true;\n    },\n    initHr() {\n      this.getRequest('/hr/info').then(resp => {\n        if (resp) {\n          this.hr = resp;\n          /*把hr的值赋值给hr2*/\n          this.hr2 = Object.assign({}, this.hr);\n          window.sessionStorage.setItem(\"user\", JSON.stringify(resp));\n          this.$store.commit('INIT_CURRENTHR', resp);\n        }\n      })\n    }\n  }\n}\n</script>\n\n<style scoped>\n\n</style>"]}]}